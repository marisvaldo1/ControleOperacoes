<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Opções - PETRN369W1</title>
    
    <!-- Tabler Core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta17/dist/css/tabler.min.css">
    <!-- Tabler Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --tblr-font-sans-serif: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            width: 100%;
            height: 280px;
        }

        /* Monospace para valores numéricos */
        .text-mono {
            font-family: 'SF Mono', 'Consolas', 'Liberation Mono', monospace;
            font-size: 13px;
        }

        /* Custom Range Slider Dark */
        .form-range-custom {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #2c3e50;
            border-radius: 4px;
            outline: none;
        }
        .form-range-custom::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            background: #206bc4;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid #1a2234;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            transition: transform 0.15s ease;
        }
        .form-range-custom::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }
        .form-range-custom::-moz-range-thumb {
            width: 22px;
            height: 22px;
            background: #206bc4;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid #1a2234;
        }

        /* Strike Line Indicator */
        .strike-indicator {
            position: absolute;
            left: 48%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #f76707;
            opacity: 0.7;
        }
        .strike-label {
            position: absolute;
            left: 48%;
            top: -25px;
            transform: translateX(-50%);
            background: #f76707;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Card Hover Effect */
        .card-hover:hover {
            border-color: #206bc4;
            transition: border-color 0.2s ease;
        }

        /* Stat Value Large */
        .stat-value-lg {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
        }

        /* Badge Custom */
        .badge-put {
            background: rgba(214, 57, 57, 0.15);
            color: #d63939;
            border: 1px solid rgba(214, 57, 57, 0.3);
        }
        .badge-sell {
            background: rgba(247, 103, 7, 0.15);
            color: #f76707;
            border: 1px solid rgba(247, 103, 7, 0.3);
        }
        .badge-otm {
            background: rgba(47, 179, 68, 0.15);
            color: #2fb344;
            border: 1px solid rgba(47, 179, 68, 0.3);
        }

        /* Greek Bars */
        .greek-bar {
            height: 6px;
            background: #2c3e50;
            border-radius: 3px;
            overflow: hidden;
        }
        .greek-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        /* Scenario Cards */
        .scenario-card {
            border-left: 4px solid;
            padding-left: 16px;
        }
        .scenario-card.profit { border-left-color: #2fb344; }
        .scenario-card.neutral { border-left-color: #f59f00; }
        .scenario-card.loss { border-left-color: #d63939; }

        /* Animation */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .tab-pane.active {
            animation: fadeInUp 0.3s ease;
        }

        /* Footer Stats */
        .footer-stat {
            text-align: center;
            padding: 0 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
        }
        .footer-stat:last-child {
            border-right: none;
        }
    </style>
</head>

<body class="theme-dark">

    <!-- Trigger Button -->
    <div class="d-flex justify-content-center align-items-center min-vh-100">
        <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#dashboardModal">
            <i class="ti ti-chart-line me-2"></i>
            Abrir Dashboard de Opções
        </button>
    </div>

    <!-- Main Modal -->
    <div class="modal modal-blur fade" id="dashboardModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable" role="document">
            <div class="modal-content border-0 shadow-lg">
                
                <!-- Modal Header -->
                <div class="modal-header border-bottom">
                    <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center gap-3 w-100">
                        <div class="d-flex align-items-center gap-2">
                            <span class="avatar bg-blue-lt">
                                <i class="ti ti-chart-candle"></i>
                            </span>
                            <div>
                                <h4 class="modal-title mb-0 d-flex align-items-center gap-2">
                                    PETRN369W1
                                    <span class="badge badge-put">PUT</span>
                                    <span class="badge badge-sell">VENDA</span>
                                    <span class="badge badge-otm">OTM</span>
                                </h4>
                            </div>
                        </div>
                        <div class="d-flex gap-4 ms-md-auto text-muted small">
                            <div><i class="ti ti-calendar me-1"></i>Venc: <strong class="text-white">06/02/2026</strong></div>
                            <div><i class="ti ti-target me-1"></i>Strike: <strong class="text-white">R$ 36,90</strong></div>
                            <div><i class="ti ti-stack me-1"></i>Qtd: <strong class="text-white">800</strong></div>
                            <div><i class="ti ti-coin me-1"></i>Prêmio: <strong class="text-green">R$ 0,30</strong></div>
                        </div>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>

                <!-- Navigation Tabs -->
                <div class="modal-header py-0 border-bottom">
                    <ul class="nav nav-tabs card-header-tabs w-100" data-bs-toggle="tabs">
                        <li class="nav-item">
                            <a href="#tab-performance" class="nav-link active" data-bs-toggle="tab">
                                <i class="ti ti-trending-up me-2"></i>Performance
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#tab-detalhes" class="nav-link" data-bs-toggle="tab">
                                <i class="ti ti-file-text me-2"></i>Detalhes
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#tab-simulacao" class="nav-link" data-bs-toggle="tab">
                                <i class="ti ti-adjustments me-2"></i>Simulação
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#tab-grafico" class="nav-link" data-bs-toggle="tab">
                                <i class="ti ti-chart-area me-2"></i>Gráfico
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#tab-risco" class="nav-link" data-bs-toggle="tab">
                                <i class="ti ti-shield-check me-2"></i>Risco
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Modal Body -->
                <div class="modal-body">
                    <div class="tab-content">
                        
                        <!-- TAB 1: PERFORMANCE -->
                        <div class="tab-pane active show" id="tab-performance">
                            <!-- Stats Row -->
                            <div class="row row-cards mb-4">
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card card-sm card-hover">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center">
                                                <span class="avatar bg-green-lt me-3">
                                                    <i class="ti ti-currency-dollar"></i>
                                                </span>
                                                <div>
                                                    <div class="text-muted small">Lucro Atual (MTM)</div>
                                                    <div class="stat-value-lg text-green">+R$ 88</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card card-sm card-hover">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center">
                                                <span class="avatar bg-azure-lt me-3">
                                                    <i class="ti ti-percentage"></i>
                                                </span>
                                                <div>
                                                    <div class="text-muted small">Retorno s/ Margem</div>
                                                    <div class="stat-value-lg text-azure">+3.25%</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card card-sm card-hover">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center">
                                                <span class="avatar bg-yellow-lt me-3">
                                                    <i class="ti ti-clock"></i>
                                                </span>
                                                <div>
                                                    <div class="text-muted small">Tempo Restante</div>
                                                    <div class="stat-value-lg text-yellow">1 dia</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card card-sm card-hover">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center">
                                                <span class="avatar bg-purple-lt me-3">
                                                    <i class="ti ti-chart-pie"></i>
                                                </span>
                                                <div>
                                                    <div class="text-muted small">Prob. de Lucro</div>
                                                    <div class="stat-value-lg text-purple">92%</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Progress Section -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="ti ti-flame me-2 text-orange"></i>
                                        Captura de Theta (Decaimento Temporal)
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <div class="d-flex justify-content-between mb-2">
                                                <span class="text-muted">Progresso do Prêmio</span>
                                                <span class="fw-bold text-white">63.3% capturado</span>
                                            </div>
                                            <div class="progress progress-lg mb-3">
                                                <div class="progress-bar bg-green" style="width: 63.3%"></div>
                                            </div>
                                            <div class="row text-center text-muted small">
                                                <div class="col">
                                                    <div class="fw-bold text-white">R$ 0,30</div>
                                                    <div>Prêmio Inicial</div>
                                                </div>
                                                <div class="col">
                                                    <div class="fw-bold text-green">R$ 0,19</div>
                                                    <div>Prêmio Atual</div>
                                                </div>
                                                <div class="col">
                                                    <div class="fw-bold text-azure">R$ 0,00</div>
                                                    <div>Alvo (Expiração)</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="card bg-green-lt">
                                                <div class="card-body text-center py-4">
                                                    <div class="text-green small fw-bold mb-1">LUCRO MÁXIMO PROJETADO</div>
                                                    <div class="display-5 fw-bold text-green">R$ 240</div>
                                                    <div class="text-muted small">Se expirar OTM</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Performance Chart -->
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="ti ti-chart-line me-2"></i>
                                        Evolução do Resultado (Intraday)
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="chartPerformance"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TAB 2: DETALHES -->
                        <div class="tab-pane" id="tab-detalhes">
                            <div class="row row-cards">
                                <!-- Cotações -->
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-live-photo me-2 text-red"></i>
                                                Cotações em Tempo Real
                                            </h3>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-vcenter card-table">
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <span class="avatar avatar-sm bg-blue-lt me-2">P4</span>
                                                            PETR4 (Spot)
                                                        </td>
                                                        <td class="text-end">
                                                            <span class="text-mono text-white">R$ 37,27</span>
                                                            <span class="badge bg-red-lt ms-2">▼ -0.35%</span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <span class="avatar avatar-sm bg-purple-lt me-2">OP</span>
                                                            PETRN369W1 (Opção)
                                                        </td>
                                                        <td class="text-end">
                                                            <span class="text-mono text-white">R$ 0,19</span>
                                                            <span class="badge bg-red-lt ms-2">▼ -36.67%</span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Strike</td>
                                                        <td class="text-end text-mono text-yellow">R$ 36,90</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Distância do Strike</td>
                                                        <td class="text-end text-mono text-green">+0.99% (OTM)</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Gregas -->
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-math-symbols me-2 text-purple"></i>
                                                Gregas da Opção
                                            </h3>
                                        </div>
                                        <div class="card-body">
                                            <!-- Delta -->
                                            <div class="mb-3">
                                                <div class="d-flex justify-content-between mb-1">
                                                    <span class="fw-medium">Delta</span>
                                                    <span class="text-mono text-azure">-0.1500</span>
                                                </div>
                                                <div class="greek-bar">
                                                    <div class="greek-bar-fill bg-azure" style="width: 15%;"></div>
                                                </div>
                                                <small class="text-muted">Sensibilidade ao preço do ativo</small>
                                            </div>
                                            <!-- Gamma -->
                                            <div class="mb-3">
                                                <div class="d-flex justify-content-between mb-1">
                                                    <span class="fw-medium">Gamma</span>
                                                    <span class="text-mono text-teal">0.0800</span>
                                                </div>
                                                <div class="greek-bar">
                                                    <div class="greek-bar-fill bg-teal" style="width: 8%;"></div>
                                                </div>
                                                <small class="text-muted">Taxa de variação do Delta</small>
                                            </div>
                                            <!-- Theta -->
                                            <div class="mb-3">
                                                <div class="d-flex justify-content-between mb-1">
                                                    <span class="fw-medium">Theta</span>
                                                    <span class="text-mono text-green">+0.0500</span>
                                                </div>
                                                <div class="greek-bar">
                                                    <div class="greek-bar-fill bg-green" style="width: 5%;"></div>
                                                </div>
                                                <small class="text-muted">Decaimento temporal (favorável para vendedor)</small>
                                            </div>
                                            <!-- Vega -->
                                            <div class="mb-3">
                                                <div class="d-flex justify-content-between mb-1">
                                                    <span class="fw-medium">Vega</span>
                                                    <span class="text-mono text-purple">0.0300</span>
                                                </div>
                                                <div class="greek-bar">
                                                    <div class="greek-bar-fill bg-purple" style="width: 3%;"></div>
                                                </div>
                                                <small class="text-muted">Sensibilidade à volatilidade</small>
                                            </div>
                                            <!-- IV -->
                                            <div class="mb-0">
                                                <div class="d-flex justify-content-between mb-1">
                                                    <span class="fw-medium">Vol. Implícita (IV)</span>
                                                    <span class="text-mono text-orange">32.5%</span>
                                                </div>
                                                <div class="greek-bar">
                                                    <div class="greek-bar-fill bg-orange" style="width: 32.5%;"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Dados da Operação -->
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-receipt me-2"></i>
                                                Detalhes da Operação
                                            </h3>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-vcenter card-table table-striped">
                                                <thead>
                                                    <tr>
                                                        <th>Parâmetro</th>
                                                        <th class="text-end">Na Abertura</th>
                                                        <th class="text-end">Atual</th>
                                                        <th class="text-end">Variação</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>Preço PETR4</td>
                                                        <td class="text-end text-mono">R$ 37,40</td>
                                                        <td class="text-end text-mono">R$ 37,27</td>
                                                        <td class="text-end text-red">-0.35%</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Prêmio Unitário</td>
                                                        <td class="text-end text-mono">R$ 0,30</td>
                                                        <td class="text-end text-mono">R$ 0,19</td>
                                                        <td class="text-end text-green">-36.67% ✓</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Valor Total da Posição</td>
                                                        <td class="text-end text-mono text-green">R$ 240,00</td>
                                                        <td class="text-end text-mono text-red">-R$ 152,00</td>
                                                        <td class="text-end text-green fw-bold">+R$ 88,00</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TAB 3: SIMULAÇÃO -->
                        <div class="tab-pane" id="tab-simulacao">
                            <div class="row row-cards">
                                <!-- Simulador -->
                                <div class="col-lg-5">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-adjustments-horizontal me-2 text-azure"></i>
                                                Simulador de Vencimento
                                            </h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-4">
                                                <label class="form-label text-muted">Preço do Ativo no Vencimento</label>
                                                <div class="d-flex align-items-center gap-3 mb-3">
                                                    <span class="badge bg-dark">R$ 34</span>
                                                    <input type="range" class="form-range-custom flex-fill" id="priceSlider" 
                                                           min="34" max="40" step="0.01" value="37.27" 
                                                           oninput="updateSimulation(this.value)">
                                                    <span class="badge bg-dark">R$ 40</span>
                                                </div>
                                                <div class="text-center">
                                                    <span class="badge bg-orange-lt">Strike: R$ 36,90</span>
                                                </div>
                                            </div>

                                            <!-- Result Display -->
                                            <div class="row text-center mb-4">
                                                <div class="col-6">
                                                    <div class="card bg-dark">
                                                        <div class="card-body py-3">
                                                            <div class="text-muted small">Preço Simulado</div>
                                                            <div class="h2 mb-0 text-white" id="simPriceDisplay">R$ 37,27</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="card bg-dark">
                                                        <div class="card-body py-3">
                                                            <div class="text-muted small">Resultado</div>
                                                            <div class="h2 mb-0 text-green" id="simResultDisplay">+R$ 240,00</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Scenario Alert -->
                                            <div class="alert alert-success" id="simAlert">
                                                <div class="d-flex">
                                                    <i class="ti ti-circle-check icon alert-icon"></i>
                                                    <div>
                                                        <h4 class="alert-title" id="simAlertTitle">Lucro Máximo</h4>
                                                        <div class="text-muted" id="simAlertText">A opção expira sem valor (OTM). Você mantém 100% do prêmio recebido.</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Cenários Pré-definidos -->
                                    <div class="card mt-3">
                                        <div class="card-header">
                                            <h3 class="card-title">Cenários Rápidos</h3>
                                        </div>
                                        <div class="list-group list-group-flush">
                                            <a href="#" class="list-group-item list-group-item-action" onclick="setSimPrice(35); return false;">
                                                <div class="d-flex justify-content-between">
                                                    <span><i class="ti ti-arrow-down text-red me-2"></i>Crash (-6%)</span>
                                                    <span class="text-red fw-bold">-R$ 1.280</span>
                                                </div>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action" onclick="setSimPrice(36.60); return false;">
                                                <div class="d-flex justify-content-between">
                                                    <span><i class="ti ti-equal text-yellow me-2"></i>Break-even</span>
                                                    <span class="text-yellow fw-bold">R$ 0</span>
                                                </div>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action" onclick="setSimPrice(38); return false;">
                                                <div class="d-flex justify-content-between">
                                                    <span><i class="ti ti-arrow-up text-green me-2"></i>Alta (+2%)</span>
                                                    <span class="text-green fw-bold">+R$ 240</span>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div>

                                <!-- Payoff Chart -->
                                <div class="col-lg-7">
                                    <div class="card h-100">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-chart-area me-2 text-green"></i>
                                                Gráfico de Payoff
                                            </h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="chart-container" style="height: 350px;">
                                                <canvas id="chartPayoff"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TAB 4: GRÁFICO -->
                        <div class="tab-pane" id="tab-grafico">
                            <div class="row row-cards">
                                <!-- Main Chart -->
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-chart-candle me-2"></i>
                                                PETR4 vs Strike (R$ 36,90)
                                            </h3>
                                            <div class="card-actions">
                                                <div class="btn-group">
                                                    <button class="btn btn-sm">1D</button>
                                                    <button class="btn btn-sm btn-primary">5D</button>
                                                    <button class="btn btn-sm">1M</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="chart-container" style="height: 380px;">
                                                <canvas id="chartPrice"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Volatility Chart -->
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-wave-sine me-2 text-purple"></i>
                                                Volatilidade (IV vs HV)
                                            </h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="chart-container" style="height: 220px;">
                                                <canvas id="chartVolatility"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Premium Decay -->
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-chart-bar me-2 text-orange"></i>
                                                Decaimento do Prêmio
                                            </h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="chart-container" style="height: 220px;">
                                                <canvas id="chartDecay"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TAB 5: RISCO -->
                        <div class="tab-pane" id="tab-risco">
                            <!-- Risk Metrics -->
                            <div class="row row-cards mb-4">
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <div class="mb-2">
                                                <span class="avatar avatar-lg bg-red-lt">
                                                    <i class="ti ti-trending-down"></i>
                                                </span>
                                            </div>
                                            <div class="text-muted small">Perda Máxima</div>
                                            <div class="h2 mb-0 text-red">-R$ 29.280</div>
                                            <small class="text-muted">Se PETR4 for a zero</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <div class="mb-2">
                                                <span class="avatar avatar-lg bg-green-lt">
                                                    <i class="ti ti-trending-up"></i>
                                                </span>
                                            </div>
                                            <div class="text-muted small">Ganho Máximo</div>
                                            <div class="h2 mb-0 text-green">+R$ 240</div>
                                            <small class="text-muted">Prêmio recebido</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <div class="mb-2">
                                                <span class="avatar avatar-lg bg-yellow-lt">
                                                    <i class="ti ti-target"></i>
                                                </span>
                                            </div>
                                            <div class="text-muted small">Break-even</div>
                                            <div class="h2 mb-0 text-yellow">R$ 36,60</div>
                                            <small class="text-muted">Strike - Prêmio</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <div class="mb-2">
                                                <span class="avatar avatar-lg bg-azure-lt">
                                                    <i class="ti ti-percentage"></i>
                                                </span>
                                            </div>
                                            <div class="text-muted small">Prob. de Lucro</div>
                                            <div class="h2 mb-0 text-azure">68%</div>
                                            <small class="text-muted">Baseado no Delta</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Scenarios -->
                            <div class="row row-cards">
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-list-check me-2"></i>
                                                Análise de Cenários
                                            </h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="scenario-card profit mb-3 p-3 rounded bg-dark">
                                                <div class="d-flex align-items-center mb-2">
                                                    <i class="ti ti-circle-check text-green me-2"></i>
                                                    <strong class="text-green">Cenário Otimista</strong>
                                                </div>
                                                <p class="text-muted small mb-0">PETR4 fecha acima de R$ 36,90. Opção expira sem valor. Lucro de R$ 240,00 (100% do prêmio).</p>
                                            </div>
                                            <div class="scenario-card neutral mb-3 p-3 rounded bg-dark">
                                                <div class="d-flex align-items-center mb-2">
                                                    <i class="ti ti-minus text-yellow me-2"></i>
                                                    <strong class="text-yellow">Cenário Neutro</strong>
                                                </div>
                                                <p class="text-muted small mb-0">PETR4 entre R$ 36,60 e R$ 36,90. Lucro parcial entre R$ 0 e R$ 240.</p>
                                            </div>
                                            <div class="scenario-card loss p-3 rounded bg-dark">
                                                <div class="d-flex align-items-center mb-2">
                                                    <i class="ti ti-alert-triangle text-red me-2"></i>
                                                    <strong class="text-red">Cenário Pessimista</strong>
                                                </div>
                                                <p class="text-muted small mb-0">PETR4 cai abaixo de R$ 36,60. Exercício da opção. Prejuízo potencial de até R$ 29.280.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">
                                                <i class="ti ti-shield me-2"></i>
                                                Métricas de Risco
                                            </h3>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-vcenter card-table">
                                                <tbody>
                                                    <tr>
                                                        <td>Capital em Risco</td>
                                                        <td class="text-end text-mono text-red">R$ 29.520,00</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Margem Requerida</td>
                                                        <td class="text-end text-mono">R$ 7.380,00</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Risco/Retorno</td>
                                                        <td class="text-end text-mono text-yellow">122:1</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Retorno sobre Margem</td>
                                                        <td class="text-end text-mono text-green">+3.25%</td>
                                                    </tr>
                                                    <tr>
                                                        <td>ROI Anualizado</td>
                                                        <td class="text-end text-mono text-azure">+1,186%</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="card-footer">
                                            <div class="alert alert-warning mb-0">
                                                <i class="ti ti-alert-circle me-2"></i>
                                                <strong>Atenção:</strong> Short Put possui risco ilimitado de queda.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="modal-footer">
                    <div class="d-flex w-100 justify-content-between align-items-center">
                        <div class="d-flex">
                            <div class="footer-stat">
                                <div class="text-muted small">Saldo Atual</div>
                                <div class="fw-bold text-white">R$ 31.179,92</div>
                            </div>
                            <div class="footer-stat">
                                <div class="text-muted small">Saldo Projetado</div>
                                <div class="fw-bold text-green">R$ 31.419,92</div>
                            </div>
                            <div class="footer-stat">
                                <div class="text-muted small">Resultado</div>
                                <div class="fw-bold text-green">+0.77%</div>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn" data-bs-dismiss="modal">Fechar</button>
                            <button type="button" class="btn btn-primary">
                                <i class="ti ti-device-floppy me-2"></i>
                                Salvar Análise
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta17/dist/js/tabler.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // Auto-open modal on page load
        document.addEventListener('DOMContentLoaded', function() {
            const modal = new bootstrap.Modal(document.getElementById('dashboardModal'));
            modal.show();
            
            // Initialize charts after modal is shown
            document.getElementById('dashboardModal').addEventListener('shown.bs.modal', function() {
                initCharts();
            });
        });

        // Simulation Logic
        function updateSimulation(price) {
            const priceFloat = parseFloat(price);
            const strike = 36.90;
            const premiumPerOption = 0.30;
            const quantity = 800;
            const totalPremium = premiumPerOption * quantity; // 240

            let result = 0;
            let scenario = '';
            let alertClass = '';
            let alertIcon = '';

            if (priceFloat >= strike) {
                // OTM - Max Profit
                result = totalPremium;
                scenario = 'profit';
                alertClass = 'alert-success';
                alertIcon = 'ti-circle-check';
            } else if (priceFloat >= strike - premiumPerOption) {
                // Between breakeven and strike - Partial Profit
                result = totalPremium - ((strike - priceFloat) * quantity);
                scenario = 'partial';
                alertClass = 'alert-warning';
                alertIcon = 'ti-alert-circle';
            } else {
                // Below breakeven - Loss
                result = totalPremium - ((strike - priceFloat) * quantity);
                scenario = 'loss';
                alertClass = 'alert-danger';
                alertIcon = 'ti-alert-triangle';
            }

            // Update UI
            document.getElementById('simPriceDisplay').textContent = 'R$ ' + priceFloat.toFixed(2);
            
            const resultEl = document.getElementById('simResultDisplay');
            resultEl.textContent = (result >= 0 ? '+' : '') + 'R$ ' + result.toFixed(2).replace('.', ',');
            resultEl.className = 'h2 mb-0 ' + (result >= 0 ? 'text-green' : 'text-red');

            // Update Alert
            const alertEl = document.getElementById('simAlert');
            const alertTitle = document.getElementById('simAlertTitle');
            const alertText = document.getElementById('simAlertText');

            alertEl.className = 'alert ' + alertClass;
            alertEl.querySelector('i').className = 'ti ' + alertIcon + ' icon alert-icon';

            if (scenario === 'profit') {
                alertTitle.textContent = 'Lucro Máximo';
                alertText.textContent = 'Opção expira OTM. Você mantém 100% do prêmio (R$ 240).';
            } else if (scenario === 'partial') {
                alertTitle.textContent = 'Lucro Parcial';
                alertText.textContent = 'Opção ITM, mas prêmio ainda cobre parte da diferença.';
            } else {
                alertTitle.textContent = 'Zona de Prejuízo';
                alertText.textContent = 'Preço abaixo do break-even (R$ 36,60). Prejuízo de R$ ' + Math.abs(result).toFixed(2);
            }
        }

        function setSimPrice(price) {
            document.getElementById('priceSlider').value = price;
            updateSimulation(price);
        }

        // Initialize Charts
        function initCharts() {
            // Dark theme defaults for Chart.js
            Chart.defaults.color = '#94a3b8';
            Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.08)';
            Chart.defaults.font.family = "'Inter', sans-serif";

            // 1. Performance Chart
            new Chart(document.getElementById('chartPerformance'), {
                type: 'line',
                data: {
                    labels: ['09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', 'Agora'],
                    datasets: [{
                        label: 'P&L (R$)',
                        data: [0, 25, 48, 35, 62, 75, 82, 88],
                        borderColor: '#2fb344',
                        backgroundColor: 'rgba(47, 179, 68, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 2,
                        pointRadius: 0,
                        pointHoverRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false } },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            ticks: { callback: v => 'R$ ' + v }
                        }
                    }
                }
            });

            // 2. Payoff Chart
            const payoffPrices = [];
            const payoffValues = [];
            for (let p = 34; p <= 40; p += 0.2) {
                payoffPrices.push(p.toFixed(2));
                payoffValues.push(p >= 36.9 ? 240 : 240 - ((36.9 - p) * 800));
            }

            new Chart(document.getElementById('chartPayoff'), {
                type: 'line',
                data: {
                    labels: payoffPrices,
                    datasets: [{
                        label: 'Resultado',
                        data: payoffValues,
                        borderColor: '#2fb344',
                        backgroundColor: 'rgba(47, 179, 68, 0.1)',
                        segment: {
                            borderColor: ctx => ctx.p0.parsed.y < 0 ? '#d63939' : '#2fb344',
                            backgroundColor: ctx => ctx.p0.parsed.y < 0 ? 'rgba(214, 57, 57, 0.1)' : 'rgba(47, 179, 68, 0.1)'
                        },
                        fill: true,
                        tension: 0,
                        borderWidth: 3,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    xMin: '36.90',
                                    xMax: '36.90',
                                    borderColor: '#f76707',
                                    borderWidth: 2,
                                    borderDash: [5, 5]
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: { maxTicksLimit: 8 }
                        },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            ticks: { callback: v => 'R$ ' + v }
                        }
                    }
                }
            });

            // 3. Price Chart
            new Chart(document.getElementById('chartPrice'), {
                type: 'line',
                data: {
                    labels: ['27/01', '28/01', '29/01', '30/01', '31/01', '03/02', '04/02', '05/02', 'Hoje'],
                    datasets: [{
                        label: 'PETR4',
                        data: [36.50, 36.80, 37.10, 37.45, 37.40, 37.20, 37.35, 37.15, 37.27],
                        borderColor: '#4299e1',
                        backgroundColor: 'rgba(66, 153, 225, 0.1)',
                        fill: true,
                        tension: 0.3,
                        borderWidth: 2
                    }, {
                        label: 'Strike (R$ 36,90)',
                        data: Array(9).fill(36.90),
                        borderColor: '#f76707',
                        borderDash: [6, 4],
                        borderWidth: 2,
                        pointRadius: 0,
                        fill: false
                    }, {
                        label: 'Break-even (R$ 36,60)',
                        data: Array(9).fill(36.60),
                        borderColor: '#d63939',
                        borderDash: [3, 3],
                        borderWidth: 1,
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { legend: { position: 'top' } },
                    scales: {
                        x: { grid: { display: false } },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            min: 35.5,
                            max: 38,
                            ticks: { callback: v => 'R$ ' + v.toFixed(2) }
                        }
                    }
                }
            });

            // 4. Volatility Chart
            new Chart(document.getElementById('chartVolatility'), {
                type: 'line',
                data: {
                    labels: ['D-10', 'D-8', 'D-6', 'D-4', 'D-2', 'Hoje'],
                    datasets: [{
                        label: 'Vol. Implícita',
                        data: [28, 30, 32, 35, 34, 32.5],
                        borderColor: '#ae3ec9',
                        backgroundColor: 'rgba(174, 62, 201, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 2
                    }, {
                        label: 'Vol. Histórica',
                        data: [25, 26, 27, 26, 27, 26],
                        borderColor: '#f59f00',
                        borderDash: [4, 4],
                        borderWidth: 2,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } },
                    scales: {
                        x: { grid: { display: false } },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            ticks: { callback: v => v + '%' }
                        }
                    }
                }
            });

            // 5. Premium Decay Chart
            new Chart(document.getElementById('chartDecay'), {
                type: 'bar',
                data: {
                    labels: ['Abertura', 'D-4', 'D-3', 'D-2', 'D-1', 'Hoje'],
                    datasets: [{
                        label: 'Prêmio (R$)',
                        data: [0.30, 0.28, 0.25, 0.22, 0.20, 0.19],
                        backgroundColor: [
                            'rgba(32, 107, 196, 0.8)',
                            'rgba(32, 107, 196, 0.7)',
                            'rgba(32, 107, 196, 0.6)',
                            'rgba(32, 107, 196, 0.5)',
                            'rgba(32, 107, 196, 0.4)',
                            'rgba(47, 179, 68, 0.8)'
                        ],
                        borderRadius: 4,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false } },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            ticks: { callback: v => 'R$ ' + v.toFixed(2) },
                            min: 0,
                            max: 0.35
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
